<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>LVM 使用 | Myblog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="本文主要介绍 LVM 的概念和基本使用。环境在 Centos 7　系统上做演示，旨在记录 LVM 基本概念，和常用操作命令，方便以后回忆。">
<meta property="og:type" content="article">
<meta property="og:title" content="LVM 使用">
<meta property="og:url" content="http://blog.iclouds.work/2017/02/14/operations/LVM%20%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="Myblog">
<meta property="og:description" content="本文主要介绍 LVM 的概念和基本使用。环境在 Centos 7　系统上做演示，旨在记录 LVM 基本概念，和常用操作命令，方便以后回忆。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-02-14T01:11:00.000Z">
<meta property="article:modified_time" content="2020-05-28T03:50:00.000Z">
<meta property="article:author" content="huagang">
<meta property="article:tag" content="centos">
<meta property="article:tag" content="lvm">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Myblog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Myblog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Hello World !</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.iclouds.work"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-operations/LVM 使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/02/14/operations/LVM%20%E4%BD%BF%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2017-02-14T01:11:00.000Z" itemprop="datePublished">2017-02-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      LVM 使用
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>本文主要介绍 LVM 的概念和基本使用。环境在 Centos 7　系统上做演示，旨在记录 LVM 基本概念，和常用操作命令，方便以后回忆。</p>
<span id="more"></span>

<blockquote>
<p>LVM是 Logical Volume Manager（逻辑卷管理）的简写，它是Linux环境下对磁盘分区进行管理的一种机制，它由Heinz Mauelshagen在Linux 2.4内核上实现，目前最新版本为：稳定版1.0.5，开发版 1.1.0-rc2，以及LVM2开发版。</p>
</blockquote>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>LVM是逻辑盘卷管理（Logical Volume Manager）的简称，它是Linux环境下对磁盘分区进行管理的一种机制，LVM是建立在硬盘和 分区之上的一个逻辑层，来提高磁盘分区管理的灵活性。通过LVM系统管理员可以轻松管理磁盘分区，如：将若干个磁盘分区连接为一个整块的卷组 （volumegroup），形成一个存储池。 管理员可以在卷组上随意创建逻辑卷组 （logical volumes），并进一步在逻辑卷组上创建文件系统。管理员通过LVM可以方便的调整存储卷组的大小，并且可以对磁盘存储按照组的方式进行命名、管理和分配，例如按照使用用途进行定义：“development”和“sales”，而不是使用物理磁盘名“sda”和“sdb”。而且当系统添加了新的磁盘，通过LVM管理员就不必将磁盘的 文件移动到新的磁盘上以充分利用新的存储空间，而是直接扩展文件系统跨越磁盘即可。</p>
<h2 id="基本术语"><a href="#基本术语" class="headerlink" title="基本术语"></a>基本术语</h2><h3 id="物理存储介质（Physical-StorageMedia）"><a href="#物理存储介质（Physical-StorageMedia）" class="headerlink" title="物理存储介质（Physical StorageMedia）"></a>物理存储介质（Physical StorageMedia）</h3><p>指系统的物理存储设备：磁盘、分区，如：/dev/hda、/dev/sda等，是存储系统最底层的存储单元。</p>
<h3 id="PV：物理卷（Physical-Volume）"><a href="#PV：物理卷（Physical-Volume）" class="headerlink" title="PV：物理卷（Physical Volume）"></a>PV：物理卷（Physical Volume）</h3><p>指磁盘分区或从逻辑上与磁盘分区具有同样功能的设备（如RAID），是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数。</p>
<h3 id="VG：卷组（Volume-Group，）"><a href="#VG：卷组（Volume-Group，）" class="headerlink" title="VG：卷组（Volume Group，）"></a>VG：卷组（Volume Group，）</h3><p>类似于非LVM系统中的物理磁盘，其由一个或多个物理卷PV组成。可以在卷组上创建一个或多个LV（逻辑卷）。</p>
<h3 id="LV：逻辑卷（Logical-Volume）"><a href="#LV：逻辑卷（Logical-Volume）" class="headerlink" title="LV：逻辑卷（Logical Volume）"></a>LV：逻辑卷（Logical Volume）</h3><p>类似于非LVM系统中的磁盘分区，逻辑卷建立在卷组VG之上。在逻辑卷LV之上可以建立文件系统（比如/home或者/usr等）。</p>
<h3 id="PE：物理块（Physical-Extent）"><a href="#PE：物理块（Physical-Extent）" class="headerlink" title="PE：物理块（Physical Extent）"></a>PE：物理块（Physical Extent）</h3><p>每一个物理卷PV被划分为称为PE（Physical Extents）的基本单元，具有唯一编号的PE是可以被LVM寻址的最小单元。PE的大小是可配置的，默认为4MB。所以物理卷（PV）由大小等同的基本单元PE组成。</p>
<h3 id="LE：逻辑块（Logical-Extent）"><a href="#LE：逻辑块（Logical-Extent）" class="headerlink" title="LE：逻辑块（Logical Extent）"></a>LE：逻辑块（Logical Extent）</h3><p>逻辑卷LV也被划分为可被寻址的基本单位，称为LE。在同一个卷组中，LE的大小和PE是相同的，并且一一对应。</p>
<blockquote>
<p>系统启动LVM时激活VG，并将VGDA加载至内存，来识别LV的实际物理存储位置。当系统进行I/O操作时，就会根据VGDA建立的映射机制来访问实际的物理位置。</p>
</blockquote>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code>本次使用 Centos 7 操作系统，
[root@localhost ~]# uname -a 
Linux localhost.localdomain 3.10.0-327.el7.x86_64 #1 SMP Thu Nov 19 22:10:57 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
</code></pre>
<p>首先确定系统中是否安装了lvm工具：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# rpm -qa | grep lvm </span><br><span class="line">mesa-private-llvm-3.6.2-2.el7.x86_64</span><br><span class="line">lvm2-2.02.130-5.el7.x86_64</span><br><span class="line">lvm2-libs-2.02.130-5.el7.x86_64</span><br></pre></td></tr></table></figure>

<p>如果命令结果输入类似于上例，那么说明系统已经安装了LVM管理工具；如果命令没有输出则说明没有安装LVM管理工具，则需要从网络下载或者从光盘装LVM rpm工具包。</p>
<h2 id="创建管理"><a href="#创建管理" class="headerlink" title="创建管理"></a>创建管理</h2><h3 id="创建分区"><a href="#创建分区" class="headerlink" title="创建分区"></a>创建分区</h3><p>使用分区工具（如：fdisk等）创建分区，如果不创建分区也可以直接使用整个磁盘。</p>
<p><strong>查看磁盘</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fdisk -l</span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;sdc：5368 MB, 5368709120 字节，10485760 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;sdb：5368 MB, 5368709120 字节，10485760 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;sda：85.9 GB, 85899345920 字节，167772160 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br><span class="line">磁盘标签类型：dos</span><br><span class="line">磁盘标识符：0x0005e789</span><br><span class="line"></span><br><span class="line">   设备 Boot      Start         End      Blocks   Id  System</span><br><span class="line">&#x2F;dev&#x2F;sda1   *        2048     1026047      512000   83  Linux</span><br><span class="line">&#x2F;dev&#x2F;sda2         1026048   167772159    83373056   8e  Linux LVM</span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;sdd：5368 MB, 5368709120 字节，10485760 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;mapper&#x2F;centos-root：81.1 GB, 81075896320 字节，158351360 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;mapper&#x2F;centos-swap：4294 MB, 4294967296 字节，8388608 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br></pre></td></tr></table></figure>

<p><strong>创建分区</strong> 使用 /dev/sdb 磁盘创建一个 2G 的分区</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fdisk &#x2F;dev&#x2F;sdb          #使用 fdisk 分区工具对 sdb 分区</span><br><span class="line">欢迎使用 fdisk (util-linux 2.23.2)。</span><br><span class="line"></span><br><span class="line">更改将停留在内存中，直到您决定将更改写入磁盘。</span><br><span class="line">使用写入命令前请三思。</span><br><span class="line"></span><br><span class="line">Device does not contain a recognized partition table</span><br><span class="line">使用磁盘标识符 0x2285b981 创建新的 DOS 磁盘标签。</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：m          # 显示菜单</span><br><span class="line">命令操作</span><br><span class="line">   a   toggle a bootable flag</span><br><span class="line">   b   edit bsd disklabel</span><br><span class="line">   c   toggle the dos compatibility flag</span><br><span class="line">   d   delete a partition          # 删除一个分区</span><br><span class="line">   g   create a new empty GPT partition table</span><br><span class="line">   G   create an IRIX (SGI) partition table</span><br><span class="line">   l   list known partition types</span><br><span class="line">   m   print this menu          # 显示菜单</span><br><span class="line">   n   add a new partition          # 创建一个新的分区</span><br><span class="line">   o   create a new empty DOS partition table</span><br><span class="line">   p   print the partition table          # 显示分区列表</span><br><span class="line">   q   quit without saving changes          # 不保存退出</span><br><span class="line">   s   create a new empty Sun disklabel</span><br><span class="line">   t   change a partition&#39;s system id          # 更改分区类型</span><br><span class="line">   u   change display&#x2F;entry units</span><br><span class="line">   v   verify the partition table</span><br><span class="line">   w   write table to disk and exit          # 写入磁盘信息并退出</span><br><span class="line">   x   extra functionality (experts only)</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：n          # 新建一个分区</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p):          # 回车使用默认，创建主分区</span><br><span class="line">Using default response p</span><br><span class="line">分区号 (1-4，默认 1)：          # 回车使用默认，创建分区号为1</span><br><span class="line">起始 扇区 (2048-10485759，默认为 2048)：           # 回车使用默认起始扇区</span><br><span class="line">将使用默认值 2048</span><br><span class="line">Last 扇区, +扇区 or +size&#123;K,M,G&#125; (2048-10485759，默认为 10485759)：+2G       # 创建大小为 2G</span><br><span class="line">分区 1 已设置为 Linux 类型，大小设为 2 GiB</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：p          # 显示分区列表</span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;sdb：5368 MB, 5368709120 字节，10485760 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br><span class="line">磁盘标签类型：dos</span><br><span class="line">磁盘标识符：0x2285b981</span><br><span class="line"></span><br><span class="line">   设备 Boot      Start         End      Blocks   Id  System</span><br><span class="line">&#x2F;dev&#x2F;sdb1            2048     4196351     2097152   83  Linux</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：n          # 创建一个分区大小为 1G 的主分区</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (1 primary, 0 extended, 3 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): </span><br><span class="line">Using default response p</span><br><span class="line">分区号 (2-4，默认 2)：</span><br><span class="line">起始 扇区 (4196352-10485759，默认为 4196352)：</span><br><span class="line">将使用默认值 4196352</span><br><span class="line">Last 扇区, +扇区 or +size&#123;K,M,G&#125; (4196352-10485759，默认为 10485759)：+1G</span><br><span class="line">分区 2 已设置为 Linux 类型，大小设为 1 GiB</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：n          创建分区，使用磁盘剩余空间作为此分区大小</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (2 primary, 0 extended, 2 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): </span><br><span class="line">Using default response p</span><br><span class="line">分区号 (3,4，默认 3)：</span><br><span class="line">起始 扇区 (6293504-10485759，默认为 6293504)：</span><br><span class="line">将使用默认值 6293504</span><br><span class="line">Last 扇区, +扇区 or +size&#123;K,M,G&#125; (6293504-10485759，默认为 10485759)：        # 不填写数值，默认使用剩余空间</span><br><span class="line">将使用默认值 10485759</span><br><span class="line">分区 3 已设置为 Linux 类型，大小设为 2 GiB</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：p</span><br><span class="line"></span><br><span class="line">磁盘 &#x2F;dev&#x2F;sdb：5368 MB, 5368709120 字节，10485760 个扇区</span><br><span class="line">Units &#x3D; 扇区 of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">扇区大小(逻辑&#x2F;物理)：512 字节 &#x2F; 512 字节</span><br><span class="line">I&#x2F;O 大小(最小&#x2F;最佳)：512 字节 &#x2F; 512 字节</span><br><span class="line">磁盘标签类型：dos</span><br><span class="line">磁盘标识符：0x2285b981</span><br><span class="line"></span><br><span class="line">   设备 Boot      Start         End      Blocks   Id  System</span><br><span class="line">&#x2F;dev&#x2F;sdb1            2048     4196351     2097152   83  Linux</span><br><span class="line">&#x2F;dev&#x2F;sdb2         4196352     6293503     1048576   83  Linux</span><br><span class="line">&#x2F;dev&#x2F;sdb3         6293504    10485759     2096128   83  Linux</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：w</span><br><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">正在同步磁盘。</span><br></pre></td></tr></table></figure>

<h3 id="创建物理卷"><a href="#创建物理卷" class="headerlink" title="创建物理卷"></a>创建物理卷</h3><p>创建物理卷的命令为 pvcreate，利用该命令将希望添加到卷组的所有 <strong>分区</strong> 或者 <strong>磁盘</strong> 创建为物理卷。将整个磁盘创建为物理卷的命令为：</p>
<p>将 <strong>分区</strong> 创建为物理卷</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# pvcreate &#x2F;dev&#x2F;sdb1           # 使用sdb1 分区创建物理卷</span><br><span class="line">  Physical volume &quot;&#x2F;dev&#x2F;sdb1&quot; successfully created</span><br><span class="line">[root@localhost ~]# pvcreate &#x2F;dev&#x2F;sdb2</span><br><span class="line">  Physical volume &quot;&#x2F;dev&#x2F;sdb2&quot; successfully created</span><br><span class="line">[root@localhost ~]# pvcreate &#x2F;dev&#x2F;sdb3</span><br><span class="line">  Physical volume &quot;&#x2F;dev&#x2F;sdb3&quot; successfully created</span><br></pre></td></tr></table></figure>

<p>将 <strong>磁盘</strong>创建为物理卷</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# pvcreate &#x2F;dev&#x2F;sdc          # 使用 sdc 磁盘创建物理卷</span><br><span class="line">  Physical volume &quot;&#x2F;dev&#x2F;sdc&quot; successfully created</span><br></pre></td></tr></table></figure>

<h3 id="查看物理卷"><a href="#查看物理卷" class="headerlink" title="查看物理卷"></a>查看物理卷</h3><p>查看物理卷的命令是 pvdisplay，可以查看当前系统的物理卷详情。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# pvdisplay</span><br><span class="line">  --- Physical volume ---</span><br><span class="line">  PV Name               &#x2F;dev&#x2F;sda2</span><br><span class="line">  VG Name               centos</span><br><span class="line">  PV Size               79.51 GiB &#x2F; not usable 3.00 MiB</span><br><span class="line">  Allocatable           yes (but full)</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              20354</span><br><span class="line">  Free PE               0</span><br><span class="line">  Allocated PE          20354</span><br><span class="line">  PV UUID               Gv6gjF-lcaF-1KOP-mJK1-ejyA-80fc-FUuf0f</span><br><span class="line">   </span><br><span class="line">  &quot;&#x2F;dev&#x2F;sdc&quot; is a new physical volume of &quot;5.00 GiB&quot;</span><br><span class="line">  --- NEW Physical volume ---</span><br><span class="line">  PV Name               &#x2F;dev&#x2F;sdc</span><br><span class="line">  VG Name               </span><br><span class="line">  PV Size               5.00 GiB</span><br><span class="line">  Allocatable           NO</span><br><span class="line">  PE Size               0   </span><br><span class="line">  Total PE              0</span><br><span class="line">  Free PE               0</span><br><span class="line">  Allocated PE          0</span><br><span class="line">  PV UUID               8x7NNq-FK15-1GLo-UeyK-6nIl-fLr2-FAs2ZH</span><br><span class="line">   </span><br><span class="line">  &quot;&#x2F;dev&#x2F;sdb2&quot; is a new physical volume of &quot;1.00 GiB&quot;</span><br><span class="line">  --- NEW Physical volume ---</span><br><span class="line">  PV Name               &#x2F;dev&#x2F;sdb2</span><br><span class="line">  VG Name               </span><br><span class="line">  PV Size               1.00 GiB</span><br><span class="line">  Allocatable           NO</span><br><span class="line">  PE Size               0   </span><br><span class="line">  Total PE              0</span><br><span class="line">  Free PE               0</span><br><span class="line">  Allocated PE          0</span><br><span class="line">  PV UUID               XA4A2B-W52C-7EoE-lsuv-5KxJ-dLdJ-QGPv1H</span><br><span class="line">   </span><br><span class="line">  &quot;&#x2F;dev&#x2F;sdb3&quot; is a new physical volume of &quot;2.00 GiB&quot;</span><br><span class="line">  --- NEW Physical volume ---</span><br><span class="line">  PV Name               &#x2F;dev&#x2F;sdb3</span><br><span class="line">  VG Name               </span><br><span class="line">  PV Size               2.00 GiB</span><br><span class="line">  Allocatable           NO</span><br><span class="line">  PE Size               0   </span><br><span class="line">  Total PE              0</span><br><span class="line">  Free PE               0</span><br><span class="line">  Allocated PE          0</span><br><span class="line">  PV UUID               9DKGiX-RdYb-re1b-P7dq-ZtkX-OGHe-0sqeB8</span><br><span class="line">   </span><br><span class="line">  &quot;&#x2F;dev&#x2F;sdb1&quot; is a new physical volume of &quot;2.00 GiB&quot;</span><br><span class="line">  --- NEW Physical volume ---</span><br><span class="line">  PV Name               &#x2F;dev&#x2F;sdb1</span><br><span class="line">  VG Name               </span><br><span class="line">  PV Size               2.00 GiB</span><br><span class="line">  Allocatable           NO</span><br><span class="line">  PE Size               0   </span><br><span class="line">  Total PE              0</span><br><span class="line">  Free PE               0</span><br><span class="line">  Allocated PE          0</span><br><span class="line">  PV UUID               6ep0dc-VUtR-SdJ8-ZzG6-n1n4-ndkO-ufPXZy</span><br></pre></td></tr></table></figure>

<blockquote>
<p>上面 sda2 是我系统的物理卷，后面为我们前面创建的。</p>
</blockquote>
<h3 id="创建卷组"><a href="#创建卷组" class="headerlink" title="创建卷组"></a>创建卷组</h3><p>创建卷组的命令为vgcreate，将使用pvcreate建立的物理卷创建为一个完整的卷组：</p>
<pre><code>vgcreate VolumeGroupName PhysicalDevicePath [PhysicalDevicePath...]
</code></pre>
<p>vgcreate命令第一个参数是指定该卷组的逻辑名：web_document。后面参数是指定希望添加到该卷组的所有分区和磁盘。vgcreate 在创建卷组web_document以外，还设置使用大小为4MB的PE（默认为4MB），这表示卷组上创建的所有逻辑卷都以4MB为增量单位来进行扩充 或缩减。由于内核原因，PE大小决定了逻辑卷的最大大小，4MB的PE决定了单个逻辑卷最大容量为256GB，若希望使用大于256G的逻辑卷则创建卷组 时指定更大的PE。PE大小范围为8KB到512MB，并且必须总是2的倍数（使用-s指定，具体请参考manvgcreate）。（centos 6.2系统已发现没有这种限制）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vgcreate test_volume &#x2F;dev&#x2F;sdb1 &#x2F;dev&#x2F;sdc         # 后面指定添加的物理卷</span><br><span class="line">  Volume group &quot;test_volume&quot; successfully created</span><br></pre></td></tr></table></figure>

<h3 id="查看卷组"><a href="#查看卷组" class="headerlink" title="查看卷组"></a>查看卷组</h3><p>查看卷组的命令为 vgdisplay，可以查看某个卷组的详细信息。</p>
<p>因为前面分区 sdb1 大小为 2G，所以创建的物理卷 sdb1 大小为 2G 。sdc 磁盘为5G。 上面把它们分给 test_volume 卷组。所以此时卷组的剩余空间为 2G，即有 2G 空间可以再分配。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vgdisplay           # 不指定参数时，会查看所有卷组</span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               test_volume</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        2</span><br><span class="line">  Metadata Sequence No  1</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                0</span><br><span class="line">  Open LV               0</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                2</span><br><span class="line">  Act PV                2</span><br><span class="line">  VG Size               6.99 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              1790</span><br><span class="line">  Alloc PE &#x2F; Size       0 &#x2F; 0   </span><br><span class="line">  Free  PE &#x2F; Size       1790 &#x2F; 6.99 GiB</span><br><span class="line">  VG UUID               jzKmzc-IJbU-cQR8-clm3-dWIC-Nvzb-pdCFPf</span><br><span class="line">   </span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               centos</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        1</span><br><span class="line">  Metadata Sequence No  3</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                2</span><br><span class="line">  Open LV               2</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                1</span><br><span class="line">  Act PV                1</span><br><span class="line">  VG Size               79.51 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              20354</span><br><span class="line">  Alloc PE &#x2F; Size       20354 &#x2F; 79.51 GiB</span><br><span class="line">  Free  PE &#x2F; Size       0 &#x2F; 0   </span><br><span class="line">  VG UUID               Abfqd4-N3hG-BJR1-2j2a-VYFQ-cRXI-OtmJmR</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# vgdisplay test_volume          # 指定查看某个卷组</span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               test_volume</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        2</span><br><span class="line">  Metadata Sequence No  1</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                0</span><br><span class="line">  Open LV               0</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                2</span><br><span class="line">  Act PV                2</span><br><span class="line">  VG Size               6.99 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              1790</span><br><span class="line">  Alloc PE &#x2F; Size       0 &#x2F; 0   </span><br><span class="line">  Free  PE &#x2F; Size       1790 &#x2F; 6.99 GiB          # 剩余空间为 7G</span><br><span class="line">  VG UUID               M54Oct-igCs-FOwl-kI0S-Bf4f-sXOi-nIw5Yw</span><br></pre></td></tr></table></figure>

<h3 id="激活卷组"><a href="#激活卷组" class="headerlink" title="激活卷组"></a>激活卷组</h3><p>为了立即使用卷组而不是重新启动系统，可以使用vgchange来激活卷组：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vgchange -ay test_volume </span><br><span class="line">  0 logical volume(s) in volume group &quot;test_volume&quot; now active</span><br></pre></td></tr></table></figure>

<h3 id="扩展卷组"><a href="#扩展卷组" class="headerlink" title="扩展卷组"></a>扩展卷组</h3><p>当系统安装了新的磁盘并创建了新的物理卷，而要将其添加到已有卷组时，就需要使用vgextend 命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# pvcreate &#x2F;dev&#x2F;sdd</span><br><span class="line">  Physical volume &quot;&#x2F;dev&#x2F;sdd&quot; successfully created</span><br><span class="line">[root@localhost ~]# vgextend test_volume &#x2F;dev&#x2F;sdd</span><br><span class="line">  Volume group &quot;test_volume&quot; successfully extended</span><br><span class="line">[root@localhost ~]# vgdisplay test_volume        </span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               test_volume</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        3</span><br><span class="line">  Metadata Sequence No  2</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                0</span><br><span class="line">  Open LV               0</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                3</span><br><span class="line">  Act PV                3</span><br><span class="line">  VG Size               11.99 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              3069</span><br><span class="line">  Alloc PE &#x2F; Size       0 &#x2F; 0   </span><br><span class="line">  Free  PE &#x2F; Size       3069 &#x2F; 11.99 GiB          # 7G + 5G </span><br><span class="line">  VG UUID               M54Oct-igCs-FOwl-kI0S-Bf4f-sXOi-nIw5Yw</span><br></pre></td></tr></table></figure>

<h3 id="减小卷组"><a href="#减小卷组" class="headerlink" title="减小卷组"></a>减小卷组</h3><p>要从一个卷组中删除一个物理卷，首先要确认要删除的物理卷没有被任何逻辑卷正在使用，就要使用pvdisplay命令察看一个该物理卷信息：<br>如果某个物理卷正在被逻辑卷所使用，就需要将该物理卷的数据备份到其他地方，然后再删除。删除物理卷的命令为vgreduce：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vgreduce test_volume &#x2F;dev&#x2F;sdc</span><br><span class="line">  Removed &quot;&#x2F;dev&#x2F;sdc&quot; from volume group &quot;test_volume&quot;</span><br><span class="line">[root@localhost ~]# vgdisplay test_volume        </span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               test_volume</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        2</span><br><span class="line">  Metadata Sequence No  3</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                0</span><br><span class="line">  Open LV               0</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                2</span><br><span class="line">  Act PV                2</span><br><span class="line">  VG Size               6.99 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              1790</span><br><span class="line">  Alloc PE &#x2F; Size       0 &#x2F; 0   </span><br><span class="line">  Free  PE &#x2F; Size       1790 &#x2F; 6.99 GiB</span><br><span class="line">  VG UUID               M54Oct-igCs-FOwl-kI0S-Bf4f-sXOi-nIw5Yw</span><br></pre></td></tr></table></figure>

<h3 id="删除卷组"><a href="#删除卷组" class="headerlink" title="删除卷组"></a>删除卷组</h3><p>当不再使用某个卷组，可以删除它。删除前，请务必备份好资料！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vgremove test_volume </span><br><span class="line">  Volume group &quot;test_volume&quot; successfully removed</span><br><span class="line">[root@localhost ~]# vgdisplay           # 查看所有卷组， test_volume 消失</span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               centos</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        1</span><br><span class="line">  Metadata Sequence No  3</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                2</span><br><span class="line">  Open LV               2</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                1</span><br><span class="line">  Act PV                1</span><br><span class="line">  VG Size               79.51 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              20354</span><br><span class="line">  Alloc PE &#x2F; Size       20354 &#x2F; 79.51 GiB</span><br><span class="line">  Free  PE &#x2F; Size       0 &#x2F; 0   </span><br><span class="line">  VG UUID               Abfqd4-N3hG-BJR1-2j2a-VYFQ-cRXI-OtmJmR</span><br></pre></td></tr></table></figure>

<h3 id="创建逻辑卷"><a href="#创建逻辑卷" class="headerlink" title="创建逻辑卷"></a>创建逻辑卷</h3><p>使用 lvcreate 创建逻辑卷。该命令就在卷组 test_volume 上创建名字为 testLV，大小为 3G 的逻辑卷，并且设备入口为 /dev/test_volume/testLV （test_volume 为卷组名， testLV 为逻辑卷名）。 创建之前，请先查看卷组的大小。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lvcreate -L 3G -n testLV test_volume </span><br><span class="line">  Logical volume &quot;testLV&quot; created.</span><br></pre></td></tr></table></figure>

<h3 id="查看逻辑卷"><a href="#查看逻辑卷" class="headerlink" title="查看逻辑卷"></a>查看逻辑卷</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lvdisplay &#x2F;dev&#x2F;test_volume&#x2F;testLV     # 不加参数查看全部逻辑卷</span><br><span class="line">  --- Logical volume ---</span><br><span class="line">  LV Path                &#x2F;dev&#x2F;test_volume&#x2F;testLV</span><br><span class="line">  LV Name                testLV</span><br><span class="line">  VG Name                test_volume</span><br><span class="line">  LV UUID                dmtbfb-XxQK-WnL1-K5BB-FdWA-FZ1z-aeexLn</span><br><span class="line">  LV Write Access        read&#x2F;write</span><br><span class="line">  LV Creation host, time localhost.localdomain, 2017-02-11 22:00:00 +0800</span><br><span class="line">  LV Status              available</span><br><span class="line">  # open                 0</span><br><span class="line">  LV Size                3.00 GiB</span><br><span class="line">  Current LE             768</span><br><span class="line">  Segments               1</span><br><span class="line">  Allocation             inherit</span><br><span class="line">  Read ahead sectors     auto</span><br><span class="line">  - currently set to     8192</span><br><span class="line">  Block device           253:2</span><br></pre></td></tr></table></figure>

<h3 id="创建文件系统，并使用"><a href="#创建文件系统，并使用" class="headerlink" title="创建文件系统，并使用"></a>创建文件系统，并使用</h3><p><strong>创建文件系统</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mkfs.ext4 &#x2F;dev&#x2F;test_volume&#x2F;testLV    </span><br><span class="line">mke2fs 1.42.9 (28-Dec-2013)</span><br><span class="line">文件系统标签&#x3D;</span><br><span class="line">OS type: Linux</span><br><span class="line">块大小&#x3D;4096 (log&#x3D;2)</span><br><span class="line">分块大小&#x3D;4096 (log&#x3D;2)</span><br><span class="line">Stride&#x3D;0 blocks, Stripe width&#x3D;0 blocks</span><br><span class="line">196608 inodes, 786432 blocks</span><br><span class="line">39321 blocks (5.00%) reserved for the super user</span><br><span class="line">第一个数据块&#x3D;0</span><br><span class="line">Maximum filesystem blocks&#x3D;805306368</span><br><span class="line">24 block groups</span><br><span class="line">32768 blocks per group, 32768 fragments per group</span><br><span class="line">8192 inodes per group</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">        32768, 98304, 163840, 229376, 294912</span><br><span class="line"></span><br><span class="line">Allocating group tables: 完成                            </span><br><span class="line">正在写入inode表: 完成                            </span><br><span class="line">Creating journal (16384 blocks): 完成</span><br><span class="line">Writing superblocks and filesystem accounting information: 完成 </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>挂载到目录</strong></p>
<blockquote>
<p><em>注意：</em> 挂载到目录之前，请备份好目录内的文件！</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mount &#x2F;dev&#x2F;test_volume&#x2F;testLV &#x2F;home&#x2F;MyVolume&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>配置开机自动挂载文件系统</strong></p>
<p>编辑 /etc/fstab 文件，追加文件系统信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vi &#x2F;etc&#x2F;fstab </span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># &#x2F;etc&#x2F;fstab</span><br><span class="line"># Created by anaconda on Fri Feb 10 16:38:19 2017</span><br><span class="line">#</span><br><span class="line"># Accessible filesystems, by reference, are maintained under &#39;&#x2F;dev&#x2F;disk&#39;</span><br><span class="line"># See man pages fstab(5), findfs(8), mount(8) and&#x2F;or blkid(8) for more info</span><br><span class="line">#</span><br><span class="line">&#x2F;dev&#x2F;mapper&#x2F;centos-root &#x2F;                       xfs     defaults        0 0</span><br><span class="line">UUID&#x3D;5725d92e-05b1-4f52-bc62-4de75b503be0 &#x2F;boot                   xfs     defaults        0 0</span><br><span class="line">&#x2F;dev&#x2F;mapper&#x2F;centos-swap swap                    swap    defaults        0 0</span><br><span class="line">&#x2F;dev&#x2F;test_volume&#x2F;testLV         &#x2F;home&#x2F;MyVolume&#x2F; ext4    default         1 2</span><br></pre></td></tr></table></figure>

<h3 id="删除一个逻辑卷"><a href="#删除一个逻辑卷" class="headerlink" title="删除一个逻辑卷"></a>删除一个逻辑卷</h3><p>删除逻辑卷之前需要将其卸载后才能删除。请备份文件系统内文件！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# umount &#x2F;home&#x2F;MyVolume&#x2F;</span><br><span class="line">[root@localhost ~]# lvremove &#x2F;dev&#x2F;test_volume&#x2F;testLV </span><br><span class="line">Do you really want to remove active logical volume testLV? [y&#x2F;n]: y</span><br><span class="line">  Logical volume &quot;testLV&quot; successfully removed</span><br></pre></td></tr></table></figure>

<h3 id="扩展逻辑卷"><a href="#扩展逻辑卷" class="headerlink" title="扩展逻辑卷"></a>扩展逻辑卷</h3><p>LVM提供了方便调整逻辑卷大小的能力，扩展逻辑卷大小的命令是lvextend。扩展之前请先查看卷组可用空间大小。如果可用空间不足，可用使用新的磁盘创建物理卷后添加至卷组。</p>
<p><strong>查看卷组大小</strong>   可用空间为 3G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vgdisplay test_volume </span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               test_volume</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        2</span><br><span class="line">  Metadata Sequence No  6</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                1</span><br><span class="line">  Open LV               0</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                2</span><br><span class="line">  Act PV                2</span><br><span class="line">  VG Size               6.99 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              1790</span><br><span class="line">  Alloc PE &#x2F; Size       768 &#x2F; 3.00 GiB</span><br><span class="line">  Free  PE &#x2F; Size       1022 &#x2F; 3.99 GiB          # 可用空间为 3G </span><br><span class="line">  VG UUID               WDFqaI-Qopl-fDJM-eeMl-3U20-aCpc-umR44I</span><br></pre></td></tr></table></figure>

<p><strong>扩展卷组</strong>   扩展后可用为 6G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vgextend test_volume &#x2F;dev&#x2F;sdb3</span><br><span class="line">  Volume group &quot;test_volume&quot; successfully extended</span><br><span class="line">[root@localhost ~]# vgdisplay test_volume         </span><br><span class="line">  --- Volume group ---</span><br><span class="line">  VG Name               test_volume</span><br><span class="line">  System ID             </span><br><span class="line">  Format                lvm2</span><br><span class="line">  Metadata Areas        3</span><br><span class="line">  Metadata Sequence No  7</span><br><span class="line">  VG Access             read&#x2F;write</span><br><span class="line">  VG Status             resizable</span><br><span class="line">  MAX LV                0</span><br><span class="line">  Cur LV                1</span><br><span class="line">  Open LV               0</span><br><span class="line">  Max PV                0</span><br><span class="line">  Cur PV                3</span><br><span class="line">  Act PV                3</span><br><span class="line">  VG Size               8.99 GiB</span><br><span class="line">  PE Size               4.00 MiB</span><br><span class="line">  Total PE              2301</span><br><span class="line">  Alloc PE &#x2F; Size       768 &#x2F; 3.00 GiB</span><br><span class="line">  Free  PE &#x2F; Size       1533 &#x2F; 5.99 GiB          # 可用空间为 6G</span><br><span class="line">  VG UUID               WDFqaI-Qopl-fDJM-eeMl-3U20-aCpc-umR44I</span><br></pre></td></tr></table></figure>

<p><strong>查看当前逻辑卷</strong>  逻辑卷大小为 3G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lvdisplay &#x2F;dev&#x2F;test_volume&#x2F;testLV </span><br><span class="line">  --- Logical volume ---</span><br><span class="line">  LV Path                &#x2F;dev&#x2F;test_volume&#x2F;testLV</span><br><span class="line">  LV Name                testLV</span><br><span class="line">  VG Name                test_volume</span><br><span class="line">  LV UUID                k3WITF-SIK1-MVhz-MdNr-exdX-5qIm-2d2IOr</span><br><span class="line">  LV Write Access        read&#x2F;write</span><br><span class="line">  LV Creation host, time localhost.localdomain, 2017-02-11 22:17:13 +0800</span><br><span class="line">  LV Status              available</span><br><span class="line">  # open                 0</span><br><span class="line">  LV Size                3.00 GiB</span><br><span class="line">  Current LE             768</span><br><span class="line">  Segments               1</span><br><span class="line">  Allocation             inherit</span><br><span class="line">  Read ahead sectors     auto</span><br><span class="line">  - currently set to     8192</span><br><span class="line">  Block device           253:2</span><br></pre></td></tr></table></figure>

<p><strong>扩展逻辑卷</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lvextend -L 6G &#x2F;dev&#x2F;test_volume&#x2F;testLV </span><br><span class="line">  Size of logical volume test_volume&#x2F;testLV changed from 3.00 GiB (768 extents) to 6.00 GiB (1536 extents).</span><br><span class="line">  Logical volume testLV successfully resized.</span><br></pre></td></tr></table></figure>

<p><strong>查看扩展后的逻辑卷</strong>  逻辑卷大小为 6G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lvdisplay &#x2F;dev&#x2F;test_volume&#x2F;testLV </span><br><span class="line">  --- Logical volume ---</span><br><span class="line">  LV Path                &#x2F;dev&#x2F;test_volume&#x2F;testLV</span><br><span class="line">  LV Name                testLV</span><br><span class="line">  VG Name                test_volume</span><br><span class="line">  LV UUID                k3WITF-SIK1-MVhz-MdNr-exdX-5qIm-2d2IOr</span><br><span class="line">  LV Write Access        read&#x2F;write</span><br><span class="line">  LV Creation host, time localhost.localdomain, 2017-02-11 22:17:13 +0800</span><br><span class="line">  LV Status              available</span><br><span class="line">  # open                 0</span><br><span class="line">  LV Size                6.00 GiB</span><br><span class="line">  Current LE             1536</span><br><span class="line">  Segments               2</span><br><span class="line">  Allocation             inherit</span><br><span class="line">  Read ahead sectors     auto</span><br><span class="line">  - currently set to     8192</span><br><span class="line">  Block device           253:2</span><br></pre></td></tr></table></figure>

<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>当向已经格式化文件系统的卷组中扩展物理卷的时候，请在创建物理卷之前将磁盘或分区格式化相应的系统。比如当我们想要向系统根目录扩展空间，因为 Centos 系统安装为 ext4 文件系统。所有需要将分区格式化为 ext4 后再扩展！！！</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>LVM具有很好的可伸缩性，使用起来非常方便。可以方便地对卷组、逻辑卷的大小进行调整，更进一步调整文件系统的大小。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.iclouds.work/2017/02/14/operations/LVM%20%E4%BD%BF%E7%94%A8/" data-id="ckmwwmzsd001keqnk9hueex8a" data-title="LVM 使用" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/centos/" rel="tag">centos</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/lvm/" rel="tag">lvm</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/11/20/documents/openldap_administrators_guide/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          OpenLDAP Software 2.4 Administrator&#39;s Guide
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CloudNative/">CloudNative</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Documents/">Documents</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jupyter-notebook/" rel="tag">Jupyter notebook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kerberos/" rel="tag">Kerberos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ambari/" rel="tag">ambari</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api-desig/" rel="tag">api-desig</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api-design/" rel="tag">api-design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/" rel="tag">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deepin/" rel="tag">deepin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fastapi/" rel="tag">fastapi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab-ci/" rel="tag">gitlab-ci</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/" rel="tag">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hbase/" rel="tag">hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hive/" rel="tag">hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kerberos/" rel="tag">kerberos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lvm/" rel="tag">lvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openldap/" rel="tag">openldap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/" rel="tag">spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zabbix/" rel="tag">zabbix</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Jupyter-notebook/" style="font-size: 10px;">Jupyter notebook</a> <a href="/tags/Kerberos/" style="font-size: 10px;">Kerberos</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/ambari/" style="font-size: 10px;">ambari</a> <a href="/tags/api-desig/" style="font-size: 10px;">api-desig</a> <a href="/tags/api-design/" style="font-size: 20px;">api-design</a> <a href="/tags/centos/" style="font-size: 17.5px;">centos</a> <a href="/tags/deepin/" style="font-size: 10px;">deepin</a> <a href="/tags/fastapi/" style="font-size: 10px;">fastapi</a> <a href="/tags/gitlab-ci/" style="font-size: 10px;">gitlab-ci</a> <a href="/tags/hadoop/" style="font-size: 10px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 10px;">hbase</a> <a href="/tags/hive/" style="font-size: 10px;">hive</a> <a href="/tags/kerberos/" style="font-size: 15px;">kerberos</a> <a href="/tags/lvm/" style="font-size: 10px;">lvm</a> <a href="/tags/openldap/" style="font-size: 12.5px;">openldap</a> <a href="/tags/python/" style="font-size: 12.5px;">python</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/spark/" style="font-size: 10px;">spark</a> <a href="/tags/zabbix/" style="font-size: 10px;">zabbix</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/09/01/api-design/microsoft_api_guide/">Microsoft REST API 准则</a>
          </li>
        
          <li>
            <a href="/2020/09/01/api-design/paypal_api_style_guide/">PayPal API 设计原则</a>
          </li>
        
          <li>
            <a href="/2020/08/28/api-design/paypal_api_first_part3/">大规模分解API优先转换。在PayPal学习的经验教训–第3部分</a>
          </li>
        
          <li>
            <a href="/2020/08/28/api-design/paypal_api_first_part2/">大规模分解API优先转换。在PayPal学习的经验教训–第2部分</a>
          </li>
        
          <li>
            <a href="/2020/08/27/api-design/paypal_api_first_part1/">大规模分解API优先转换。在PayPal学习的经验教训–第1部分</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 huagang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>